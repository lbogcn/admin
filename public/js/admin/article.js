define(["jquery","ueditor","zeroclipboard","datetimepicker","datetimepicker-lang","ueditor-lang","bootstrap"],function(a,t,i){function e(t){if(t){var i=!1;if(a(".tag","#tagBox").each(function(){if(a(this).data("tag")==t)return i=!0,!1}),!i){var e=a('<div class="tag pull-left" style="margin-right: 5px;">                    <span class="glyphicon glyphicon-remove-sign"></span>                    <a href="javascript:void(0);"></a>                    <input type="hidden" name="tag[]" role="tag">                    </div>');e.attr("data-tag",t).data("tag",t),e.find("a").html(t),e.find("[role=tag]").val(t),a("#tagBox").append(e),e.find(".glyphicon-remove-sign").click(function(){e.remove()})}}}var o={tagOption:function(){a("#btnAddTag").click(function(){var t=a("#iptTags").val().split(",");a("#iptTags").val("");for(var i in t)e(t[i])}),a("#btnAllTagBox").click(function(){a("#allTagBox").hasClass("hide")?a("#allTagBox").removeClass("hide"):a("#allTagBox").addClass("hide")}),a(".tag","#allTagBox").click(function(){e(a(this).html())})},preview:function(){a("#btnPreview").click(function(){var t=a('<form class="hide" action="/article-manage/article/preview" target="_blank" method="post">                    <input type="hidden" name="_token" value="'+a('meta[name="csrf-token"]').attr("content")+'">                </form>');a.each(a("#dataForm").serializeArray(),function(i,e){var o=a('<input type="text">');o.val(e.value),o.attr("name",e.name),t.append(o)}),a("body").append(t),t.submit(),t.remove()})},coverOption:function(t){var i=this;a("input[name=cover_type]").click(function(){1==a(this).val()?(a("#cover-box").addClass("hide"),a("#img-cover-url").attr("src",""),a("[name=cover_url]").val("")):(2==a(this).val()?a("#img-cover-url").addClass("small").removeClass("big"):a("#img-cover-url").addClass("big").removeClass("small"),a("#cover-box").removeClass("hide"))}),a("#btn-cover-choose").click(function(){var e=a('<div class="modal fade" tabindex="-1" role="dialog">                                      <div class="modal-dialog" role="document">                                        <div class="modal-content">                                          <div class="modal-header">                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                                            <h4 class="modal-title">请选择</h4>                                          </div>                                          <div class="modal-body">                                            <div class="row"><div class="col-xs-12 modal-images-list"></div></div>                                          </div>                                          <div class="modal-footer">                                            <button type="button" class="btn btn-primary btn-ok">确定</button>                                          </div>                                        </div>                                      </div>                                    </div>'),o=e.find(".modal-images-list"),n=[];a(t.getContent()).find("img").each(function(){a.inArray(a(this).attr("src"),n)<0&&n.push(a(this).attr("src"))}),a.each(n,function(t,i){var e=a('<div class="modal-images-item"><img></div>');e.children("img").attr("src",i),e.click(function(){o.find(".modal-images-item").removeClass("active"),a(this).addClass("active")}),o.append(e)}),e.find(".btn-ok").click(function(){i.loadCover(o.find(".active img").attr("src")),e.modal("toggle").on("hidden.bs.modal",function(){e.remove()})}),e.modal()}),a("#btn-cover-upload").click(function(){})},loadCover:function(t){a("#img-cover-url").attr("src",t),a("[name=cover_url]").val(t)},init:function(){window.ZeroClipboard=i,window.uploadToken=a("#uploadToken").html();var e=t.getEditor("editor");a(".datetimepicker").datetimepicker({format:"yyyy-mm-dd",language:"zh-CN",minView:2,maxView:"year",autoclose:!0,todayBtn:!0,todayHighlight:!0,weekStart:0}),this.tagOption(),this.preview(),this.coverOption(e)},addTag:e};return o.init(),o});