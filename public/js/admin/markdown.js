define(["vue","uploader","jquery","restful","bootstrap","hyperdown","vue-datetime-picker","css!/css/admin/article.css"],function(t,e,a,i){t.config.debug=!0;var o=window.HyperDown,n=new o,s=new e(a("#uploadToken").html());new t({el:"#container",data:{form:{},preview:"",isShowCoverBox:!1,isShowAllTagBox:!1,isCreated:!1,iptTags:""},methods:{coverUpload:function(){var t=this;s.upload(function(e){t.form.cover_url=e})},coverChoose:function(){var t=this,e=a('<div class="modal fade" tabindex="-1" role="dialog">                                      <div class="modal-dialog" role="document">                                        <div class="modal-content">                                          <div class="modal-header">                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                                            <h4 class="modal-title">请选择</h4>                                          </div>                                          <div class="modal-body">                                            <div class="row"><div class="col-xs-12 modal-images-list"></div></div>                                          </div>                                          <div class="modal-footer">                                            <button type="button" class="btn btn-primary btn-ok">确定</button>                                          </div>                                        </div>                                      </div>                                    </div>'),i=e.find(".modal-images-list"),o=[];a(this.preview).find("img").each(function(){a.inArray(a(this).attr("src"),o)<0&&o.push(a(this).attr("src"))}),a.each(o,function(t,e){var o=a('<div class="modal-images-item"><img></div>');o.children("img").attr("src",e),o.click(function(){i.find(".modal-images-item").removeClass("active"),a(this).addClass("active")}),i.append(o)}),e.find(".btn-ok").click(function(){t.form.cover_url=i.find(".active img").attr("src"),e.modal("toggle").on("hidden.bs.modal",function(){e.remove()})}),e.modal()},addIptTags:function(){var t=this.iptTags.split(",");this.iptTags="";var e=this;t.map(function(t){e.addTag(t)})},removeTag:function(t){this.form.tag.splice(t,1)},addTag:function(t){t&&a.inArray(t,this.form.tag)===-1&&this.form.tag.push(t)},submit:function(t){var e=t.target;i.post(e.action,this.form)},showPreview:function(){var t=document.createElement("form"),e=a.extend(this.form,{});e._token=a('meta[name="csrf-token"]').attr("content"),t.action="/article-manage/markdown/preview",t.method="POST",t.style.display="none",t.target="_blank",a.each(e,function(e,i){if("_method"!==e)if("object"==typeof i)a.each(i,function(a,i){var o=document.createElement("textarea");o.name=e+"[]",o.value=i,t.appendChild(o)});else{var o=document.createElement("textarea");o.name=e,o.value=i,t.appendChild(o)}}),document.body.appendChild(t),t.submit(),t.remove()}},watch:{"form.content":function(t){this.preview=n.makeHtml(t)},"form.cover_type":function(t){this.isShowCoverBox=1!==parseInt(t)}},created:function(){this.form=window.form},mounted:function(){a(this.$el).removeClass("hide")}})});